<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Taskbaji CAPTCHA Site</title>
  <style>
    body { font-family: Arial; padding: 20px; background: #f0f0f0; }
    .container { max-width: 400px; margin: auto; background: white; padding: 20px; border-radius: 8px; }
    input, button { display: block; width: 100%; margin: 10px 0; padding: 10px; }
    #dashboard, #taskPage, #withdrawPage, #ownerDashboard, #sidebar { display: none; }
    #menuBtn { float: right; margin-top: -40px; }
  </style>
</head>
<body>

<div class="container" id="registerPage">
  <h2>Register</h2>
  <input id="regEmail" placeholder="Email">
  <input id="regPass" placeholder="Password" type="password">
  <button onclick="register()">Register</button>
  <p>Already have an account? <a href="#" onclick="showLogin()">Login</a></p>
</div>

<div class="container" id="loginPage" style="display:none">
  <h2>Login</h2>
  <input id="logEmail" placeholder="Email">
  <input id="logPass" placeholder="Password" type="password">
  <button onclick="login()">Login</button>
</div>

<div class="container" id="dashboard">
  <h2>Welcome, <span id="userEmail"></span></h2>
  <button id="menuBtn" onclick="toggleSidebar()">â˜°</button>
  <p>Points: <span id="points">0</span></p>
</div>

<div id="sidebar" style="position:fixed; top:0; right:0; background:#333; color:#fff; width:200px; height:100vh; padding:10px;">
  <p onclick="showDashboard()">Dashboard</p>
  <p onclick="showTaskPage()">Start Now</p>
  <p onclick="showWithdraw()">Withdraw</p>
  <p id="ownerOption" style="display:none" onclick="showOwnerDashboard()">Owner Dashboard</p>
  <p onclick="logout()">Exit</p>
</div>

<div class="container" id="taskPage">
  <h2>Solve CAPTCHA</h2>
  <div id="captchaBox"></div>
  <input id="captchaAnswer" placeholder="Answer">
  <button onclick="checkCaptcha()">Submit</button>
</div>

<div class="container" id="withdrawPage">
  <h2>Withdraw</h2>
  <p>Your points: <span id="withdrawPoints">0</span></p>
  <button onclick="alert('Withdraw Requested')">Request Withdraw</button>
</div>

<div class="container" id="ownerDashboard">
  <h2>Owner Dashboard</h2>
  <p>Total User Earnings: <span id="totalEarnings">0</span></p>
</div>

<script>
let user = {}, totalPoints = 0;
const adminEmail = "shamindranathroy681@gmail.com";
const adminPass = "S89000r&";

function showLogin() {
  document.getElementById('registerPage').style.display = 'none';
  document.getElementById('loginPage').style.display = 'block';
}

function register() {
  const email = document.getElementById('regEmail').value;
  const pass = document.getElementById('regPass').value;
  localStorage.setItem(email, pass);
  alert("Registered!");
  showLogin();
}

function login() {
  const email = document.getElementById('logEmail').value;
  const pass = document.getElementById('logPass').value;
  const stored = localStorage.getItem(email);
  if (stored === pass) {
    user.email = email;
    user.points = parseInt(localStorage.getItem(email + "_points")) || 0;
    document.getElementById("userEmail").innerText = email;
    document.getElementById("points").innerText = user.points;
    document.getElementById("withdrawPoints").innerText = user.points;
    document.getElementById("registerPage").style.display = 'none';
    document.getElementById("loginPage").style.display = 'none';
    document.getElementById("dashboard").style.display = 'block';
    if (email === adminEmail && pass === adminPass) {
      document.getElementById("ownerOption").style.display = "block";
    }
  } else {
    alert("Invalid Login");
  }
}

function toggleSidebar() {
  const sidebar = document.getElementById("sidebar");
  sidebar.style.display = sidebar.style.display === "block" ? "none" : "block";
}

function showDashboard() {
  hideAll();
  document.getElementById("dashboard").style.display = "block";
}

function showTaskPage() {
  hideAll();
  document.getElementById("taskPage").style.display = "block";
  generateCaptcha();
}

function showWithdraw() {
  hideAll();
  document.getElementById("withdrawPage").style.display = "block";
  document.getElementById("withdrawPoints").innerText = user.points;
}

function showOwnerDashboard() {
  hideAll();
  document.getElementById("ownerDashboard").style.display = "block";
  document.getElementById("totalEarnings").innerText = localStorage.getItem("total_points") || 0;
}

function logout() {
  location.reload();
}

function hideAll() {
  document.getElementById("dashboard").style.display = "none";
  document.getElementById("taskPage").style.display = "none";
  document.getElementById("withdrawPage").style.display = "none";
  document.getElementById("ownerDashboard").style.display = "none";
}

let a, b;
function generateCaptcha() {
  a = Math.floor(Math.random()*10);
  b = Math.floor(Math.random()*10);
  document.getElementById("captchaBox").innerText = `Solve: ${a} + ${b}`;
}

function checkCaptcha() {
  const ans = parseInt(document.getElementById("captchaAnswer").value);
  if (ans === a + b) {
    user.points += 10;
    localStorage.setItem(user.email + "_points", user.points);
    document.getElementById("points").innerText = user.points;
    alert("Correct! +10 points");
    // Add to owner
    let total = parseInt(localStorage.getItem("total_points")) || 0;
    total += 10;
    localStorage.setItem("total_points", total);
    generateCaptcha();
  } else {
    alert("Wrong answer");
  }
}
</script>

</body>
  </html>
